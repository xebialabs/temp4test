apply plugin: 'java'
apply plugin: 'eclipse'
apply plugin: 'release-plugin'

configurations {
  distBundle
}

dependencies {
  compile 'org.eclipse.jgit:org.eclipse.jgit:2.0.0.201206130900-r'
  // snapshot for testing
  compile 'com.xebialabs.deployit:engine-api:4.0.0'

  // 
  distBundle 'com.xebialabs.deployit:engine-api:4.0.0'
}

subprojects.each { p ->
	p.apply plugin: 'java'
}

allprojects.each { p->
  p.tasks.create('uploadArchives').configure {
    doLast {
      println "Uploading ${project.jar.outputs.files.files}"
    }
  }
}

release {
  //releaseTasks = [ ':build', ':uploadArchives', ':sub1:uploadArchives', ':sub2:uploadArchives' ]
  releaseTasks = project.getTasksByName('uploadArchives', true) + project.getTasksByName('build', true)
}
