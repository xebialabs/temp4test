buildscript {
  repositories {
    mavenLocal()
    ['releases', 'public'].each { r ->
      maven {
        url "${nexusBaseUrl}/repositories/${r}"
          credentials {
            username nexusUserName
            password nexusPassword
        }
      }
    }
  }
  dependencies {
    classpath "com.xebialabs.gradle.plugins:gradle-xl-plugins-plugin:${xlPluginPluginVersion}"
    classpath "com.xebialabs.gradle.plugins:gradle-xl-restdoc-plugin:${xlRestDocPluginVersion}"
  }
}

apply plugin: 'xebialabs.root.opinions'
apply plugin: 'xebialabs.dependency'

allprojects { p ->
  group = 'com.xebialabs.deployit.temp4test'

  p.apply plugin: 'idea'

  p.tasks.findByName('uploadArchives')?.with { Task uploadTask ->
    log.info("Release task ${p.tasks.release} depends on ${uploadTask}")
    rootProject.tasks.release.dependsOn uploadTask
  }
  p.tasks.findAll({ it.name == 'build' }).each { Task buildTask ->
    log.info("${p.tasks.release} depends on ${buildTask}")
    rootProject.tasks.releases.dependsOn buildTask
  }
}



println "Root project done"

